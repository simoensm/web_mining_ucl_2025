import pandas as pd
import os

# --- CONFIGURATION MANUELLE ---
# Notez ici les noms exacts de vos fichiers présents dans votre dossier VS Code
FILES_TO_MERGE = [
    '.patagonia/patagonia_men_products.xlsx',
    '.patagonia/patagonia_women_products.xlsx',
]

OUTPUT_FILENAME = '.patagonia/all_patagonia_products.xlsx'

def merge_manual_files():
    all_data_frames = []
    
    print(f"Début de la compilation de {len(FILES_TO_MERGE)} fichiers...")
    
    for filename in FILES_TO_MERGE:
        # Vérification si le fichier existe pour éviter un crash
        if os.path.exists(filename):
            try:
                df = pd.read_excel(filename)
                
                # Ajout de la colonne source pour la traçabilité
                df['Source_File'] = filename
                
                all_data_frames.append(df)
                print(f" -> Ajouté avec succès : {filename} ({len(df)} lignes)")
                
            except Exception as e:
                print(f" ! Erreur lors de la lecture de {filename} : {e}")
        else:
            print(f" ! Attention : Le fichier '{filename}' est introuvable dans le dossier.")

    # Fusion finale et export
    if all_data_frames:
        print("\nFusion des données en cours...")
        merged_df = pd.concat(all_data_frames, ignore_index=True)
        
        # Sauvegarde au format Excel pour le corpus final
        merged_df.to_excel(OUTPUT_FILENAME, index=False)
        
        print(f"\nTERMINE : Fichier '{OUTPUT_FILENAME}' créé.")
        print(f"Nombre total de produits compilés : {len(merged_df)}")
    else:
        print("Erreur : Aucun fichier n'a pu être compilé.")

if __name__ == "__main__":
    merge_manual_files()